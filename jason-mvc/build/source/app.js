"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var dispatcher_1 = require("./dispatcher");
var mediator_1 = require("./mediator");
var app_event_1 = require("./app_event");
var router_1 = require("./router");
var App = (function () {
    function App(appSettings) {
        this._contollers = appSettings.controllers;
        this._mediator = new mediator_1.Mediator(appSettings.isDebug || false);
        this._router = new router_1.Router(this._mediator, appSettings.defaultController, appSettings.defaultAction);
        this._dispatcher = new dispatcher_1.Dispatcher(this._mediator, this._contollers);
        this._onErrorHandler = appSettings.onErrorHandler;
    }
    App.prototype.initialize = function () {
        var _this = this;
        this._router.initialize();
        this._dispatcher.initialize();
        this._mediator.subscribe(new app_event_1.AppEvent("app.error", null, function (e, data) {
            _this._onErrorHandler(data);
        }));
        this._mediator.publish(new app_event_1.AppEvent("app.initialize", null, null));
    };
    return App;
}());
exports.App = App;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUVBLDJDQUEwQztBQUMxQyx1Q0FBc0M7QUFDdEMseUNBQXVDO0FBQ3ZDLG1DQUFrQztBQUVsQztJQU1JLGFBQVksV0FBeUI7UUFDakMsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUMsV0FBVyxDQUFDO1FBQzNDLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxtQkFBUSxDQUFDLFdBQVcsQ0FBQyxPQUFPLElBQUksS0FBSyxDQUFDLENBQUM7UUFDNUQsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLGVBQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFdBQVcsQ0FBQyxpQkFBaUIsRUFBRSxXQUFXLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDcEcsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLHVCQUFVLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDcEUsSUFBSSxDQUFDLGVBQWUsR0FBRyxXQUFXLENBQUMsY0FBYyxDQUFDO0lBQ3RELENBQUM7SUFDTSx3QkFBVSxHQUFqQjtRQUFBLGlCQU9DO1FBTkcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUMxQixJQUFJLENBQUMsV0FBVyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQzlCLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLElBQUksb0JBQVEsQ0FBQyxXQUFXLEVBQUUsSUFBSSxFQUFFLFVBQUMsQ0FBTSxFQUFFLElBQVU7WUFDeEUsS0FBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMvQixDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ0osSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsSUFBSSxvQkFBUSxDQUFDLGdCQUFnQixFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ3ZFLENBQUM7SUFDTCxVQUFDO0FBQUQsQ0FyQkEsQUFxQkMsSUFBQTtBQUVRLGtCQUFHIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuL2ludGVyZmFjZXMudHNcIiAvPlxyXG5cclxuaW1wb3J0IHsgRGlzcGF0Y2hlciB9IGZyb20gXCIuL2Rpc3BhdGNoZXJcIjtcclxuaW1wb3J0IHsgTWVkaWF0b3IgfSBmcm9tIFwiLi9tZWRpYXRvclwiO1xyXG5pbXBvcnQgeyBBcHBFdmVudCB9IGZyb20gXCIuL2FwcF9ldmVudFwiO1xyXG5pbXBvcnQgeyBSb3V0ZXIgfSBmcm9tIFwiLi9yb3V0ZXJcIjtcclxuXHJcbmNsYXNzIEFwcCB7XHJcbiAgICBwcml2YXRlIF9kaXNwYXRjaGVyOiBJRGlzcGF0Y2hlcjtcclxuICAgIHByaXZhdGUgX21lZGlhdG9yOiBJTWVkaWF0b3I7XHJcbiAgICBwcml2YXRlIF9yb3V0ZXI6IElSb3V0ZXI7XHJcbiAgICBwcml2YXRlIF9jb250b2xsZXJzOiBJQ29udHJvbGxlckRldGFpbHNbXTtcclxuICAgIHByaXZhdGUgX29uRXJyb3JIYW5kbGVyOiAobzogT2JqZWN0KSA9PiB2b2lkO1xyXG4gICAgY29uc3RydWN0b3IoYXBwU2V0dGluZ3M6IElBcHBTZXR0aW5ncykge1xyXG4gICAgICAgIHRoaXMuX2NvbnRvbGxlcnMgPSBhcHBTZXR0aW5ncy5jb250cm9sbGVycztcclxuICAgICAgICB0aGlzLl9tZWRpYXRvciA9IG5ldyBNZWRpYXRvcihhcHBTZXR0aW5ncy5pc0RlYnVnIHx8IGZhbHNlKTtcclxuICAgICAgICB0aGlzLl9yb3V0ZXIgPSBuZXcgUm91dGVyKHRoaXMuX21lZGlhdG9yLCBhcHBTZXR0aW5ncy5kZWZhdWx0Q29udHJvbGxlciwgYXBwU2V0dGluZ3MuZGVmYXVsdEFjdGlvbik7XHJcbiAgICAgICAgdGhpcy5fZGlzcGF0Y2hlciA9IG5ldyBEaXNwYXRjaGVyKHRoaXMuX21lZGlhdG9yLCB0aGlzLl9jb250b2xsZXJzKTtcclxuICAgICAgICB0aGlzLl9vbkVycm9ySGFuZGxlciA9IGFwcFNldHRpbmdzLm9uRXJyb3JIYW5kbGVyO1xyXG4gICAgfVxyXG4gICAgcHVibGljIGluaXRpYWxpemUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5fcm91dGVyLmluaXRpYWxpemUoKTtcclxuICAgICAgICB0aGlzLl9kaXNwYXRjaGVyLmluaXRpYWxpemUoKTtcclxuICAgICAgICB0aGlzLl9tZWRpYXRvci5zdWJzY3JpYmUobmV3IEFwcEV2ZW50KFwiYXBwLmVycm9yXCIsIG51bGwsIChlOiBhbnksIGRhdGE/OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fb25FcnJvckhhbmRsZXIoZGF0YSk7XHJcbiAgICAgICAgfSkpO1xyXG4gICAgICAgIHRoaXMuX21lZGlhdG9yLnB1Ymxpc2gobmV3IEFwcEV2ZW50KFwiYXBwLmluaXRpYWxpemVcIiwgbnVsbCwgbnVsbCkpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBBcHAgfTsiXX0=
