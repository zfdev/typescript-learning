"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
require("reflect-metadata");
function logType(target, key) {
    var t = Reflect.getMetadata('design:type', target, key);
    console.log(key + " type: " + t.name);
}
var Person = (function () {
    function Person(name, surname) {
        this.name = name;
        this.surname = surname;
    }
    Person.prototype.saySomething = function (something) {
        return this.name + '' + this.surname + something;
    };
    __decorate([
        log,
        __metadata("design:type", String)
    ], Person.prototype, "name", void 0);
    __decorate([
        logType,
        __param(0, log),
        __metadata("design:type", Function),
        __metadata("design:paramtypes", [String]),
        __metadata("design:returntype", String)
    ], Person.prototype, "saySomething", null);
    Person = __decorate([
        log,
        __metadata("design:paramtypes", [String, String])
    ], Person);
    return Person;
}());
function logClass(target) {
    var original = target;
    function construct(constructor, args) {
        var c = function () {
            return constructor.apply(this, args);
        };
        c.prototype = constructor.prototype;
        return new c();
    }
    var f = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        console.log("New:" + original.name);
        return construct(original, args);
    };
    f.prototype = original.prototype;
    return f;
}
var me = new Person('Jason', 'Zhang');
me.saySomething('Hello');
function logMethod(target, key, descriptor) {
    var originalMethod = descriptor.value;
    descriptor.value = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var a = args.map(function (a) { return JSON.stringify(a); }).join();
        var result = originalMethod.apply(this, args);
        var r = JSON.stringify(result);
        console.log("Call:" + key + "(" + a + ")=>" + r);
        return result;
    };
    return descriptor;
}
function logProperty(target, key) {
    var _val = this[key];
    var getter = function () {
        console.log("Get: " + key + " => " + _val);
        return _val;
    };
    var setter = function (newVal) {
        console.log("Set: " + key + " => " + newVal);
        _val = newVal;
    };
    if (delete this[key]) {
        Object.defineProperty(target, key, {
            get: getter,
            set: setter,
            enumerable: true,
            configurable: true
        });
    }
}
function logParameter(target, key, index) {
    var metadataKey = "_log_" + key + "_parameters";
    if (Array.isArray(target[metadataKey])) {
        target[metadataKey].push(index);
    }
    else {
        target[metadataKey] = [index];
    }
}
function readMetadata(target, key, descriptor) {
    var originalMethod = descriptor.value;
    descriptor.value = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var metadataKey = "_log_" + key + "_parameters";
        var indices = target[metadataKey];
        if (Array.isArray(indices)) {
            for (var i = 0; i < args.length; i++) {
                if (indices.indexOf(i) !== -1) {
                    var arg = args[i];
                    var argStr = JSON.stringify(arg) || arg.toString();
                    console.log(key + " arg[" + i + "]: " + argStr);
                }
            }
            var result = originalMethod.apply(this, args);
            return result;
        }
    };
    return descriptor;
}
function log() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    switch (args.length) {
        case 1:
            return logClass.apply(this, args);
        case 2:
            logProperty.apply(this.args);
            break;
        case 3:
            if (typeof args[2] === "number") {
                logParameter.apply(this, args);
            }
            return logMethod.apply(this, args);
        default:
            throw new Error('Decorators are not valid here!');
    }
}
var TaskModel = (function () {
    function TaskModel() {
    }
    return TaskModel;
}());
var Router = (function () {
    function Router(controllerName, actionName, args) {
        this.controllerName = controllerName;
        this.actionName = actionName;
        this.args = args;
    }
    return Router;
}());

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUE2ZkEsNEJBQTBCO0FBRTFCLGlCQUFpQixNQUFXLEVBQUUsR0FBVztJQUNyQyxJQUFJLENBQUMsR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLGFBQWEsRUFBRSxNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDeEQsT0FBTyxDQUFDLEdBQUcsQ0FBSSxHQUFHLGVBQVUsQ0FBQyxDQUFDLElBQU0sQ0FBQyxDQUFDO0FBQzFDLENBQUM7QUFHRDtJQUlJLGdCQUFZLElBQVksRUFBRSxPQUFlO1FBQ3JDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO0lBQzNCLENBQUM7SUFFTSw2QkFBWSxHQUFuQixVQUF5QixTQUFpQjtRQUN0QyxPQUFPLElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQyxPQUFPLEdBQUcsU0FBUyxDQUFDO0lBQ3JELENBQUM7SUFURDtRQURDLEdBQUc7O3dDQUNnQjtJQU9wQjtRQURDLE9BQU87UUFDYSxXQUFBLEdBQUcsQ0FBQTs7Ozs4Q0FFdkI7SUFYQyxNQUFNO1FBRFgsR0FBRzs7T0FDRSxNQUFNLENBWVg7SUFBRCxhQUFDO0NBWkQsQUFZQyxJQUFBO0FBS0Qsa0JBQWtCLE1BQVc7SUFDekIsSUFBSSxRQUFRLEdBQUcsTUFBTSxDQUFDO0lBRXRCLG1CQUFtQixXQUFXLEVBQUUsSUFBSTtRQUNoQyxJQUFJLENBQUMsR0FBUTtZQUNULE9BQU8sV0FBVyxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDekMsQ0FBQyxDQUFBO1FBQ0QsQ0FBQyxDQUFDLFNBQVMsR0FBRyxXQUFXLENBQUMsU0FBUyxDQUFDO1FBQ3BDLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQztJQUNuQixDQUFDO0lBR0QsSUFBSSxDQUFDLEdBQU87UUFBUyxjQUFPO2FBQVAsVUFBTyxFQUFQLHFCQUFPLEVBQVAsSUFBTztZQUFQLHlCQUFPOztRQUN4QixPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEMsT0FBTyxTQUFTLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3JDLENBQUMsQ0FBQTtJQUVELENBQUMsQ0FBQyxTQUFTLEdBQUcsUUFBUSxDQUFDLFNBQVMsQ0FBQztJQUNqQyxPQUFPLENBQUMsQ0FBQztBQUNiLENBQUM7QUFFRCxJQUFJLEVBQUUsR0FBRyxJQUFJLE1BQU0sQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDdEMsRUFBRSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUd6QixtQkFBbUIsTUFBVyxFQUFFLEdBQVcsRUFBRSxVQUFlO0lBQ3hELElBQUksY0FBYyxHQUFHLFVBQVUsQ0FBQyxLQUFLLENBQUM7SUFDdEMsVUFBVSxDQUFDLEtBQUssR0FBRztRQUFTLGNBQWM7YUFBZCxVQUFjLEVBQWQscUJBQWMsRUFBZCxJQUFjO1lBQWQseUJBQWM7O1FBQ3RDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFqQixDQUFpQixDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDaEQsSUFBSSxNQUFNLEdBQUcsY0FBYyxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDOUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMvQixPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVEsR0FBRyxTQUFJLENBQUMsV0FBTSxDQUFHLENBQUMsQ0FBQztRQUN2QyxPQUFPLE1BQU0sQ0FBQztJQUNsQixDQUFDLENBQUE7SUFDRCxPQUFPLFVBQVUsQ0FBQztBQUN0QixDQUFDO0FBSUQscUJBQXFCLE1BQVcsRUFBRSxHQUFXO0lBQ3pDLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNyQixJQUFJLE1BQU0sR0FBRztRQUNULE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBUSxHQUFHLFlBQU8sSUFBTSxDQUFDLENBQUM7UUFDdEMsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQyxDQUFBO0lBQ0QsSUFBSSxNQUFNLEdBQUcsVUFBUyxNQUFNO1FBQ3hCLE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBUSxHQUFHLFlBQU8sTUFBUSxDQUFDLENBQUM7UUFDeEMsSUFBSSxHQUFHLE1BQU0sQ0FBQztJQUNsQixDQUFDLENBQUE7SUFFRCxJQUFHLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFDO1FBQ2hCLE1BQU0sQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRTtZQUMvQixHQUFHLEVBQUUsTUFBTTtZQUNYLEdBQUcsRUFBRSxNQUFNO1lBQ1gsVUFBVSxFQUFFLElBQUk7WUFDaEIsWUFBWSxFQUFFLElBQUk7U0FDckIsQ0FBQyxDQUFDO0tBQ047QUFDTCxDQUFDO0FBR0Qsc0JBQXNCLE1BQVcsRUFBRSxHQUFXLEVBQUUsS0FBYTtJQUN6RCxJQUFJLFdBQVcsR0FBRyxVQUFRLEdBQUcsZ0JBQWEsQ0FBQztJQUMzQyxJQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLEVBQUM7UUFDbEMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUNuQztTQUFJO1FBQ0QsTUFBTSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7S0FDakM7QUFDTCxDQUFDO0FBRUQsc0JBQXNCLE1BQVcsRUFBRSxHQUFXLEVBQUUsVUFBZTtJQUMzRCxJQUFJLGNBQWMsR0FBRyxVQUFVLENBQUMsS0FBSyxDQUFDO0lBQ3RDLFVBQVUsQ0FBQyxLQUFLLEdBQUc7UUFBUyxjQUFjO2FBQWQsVUFBYyxFQUFkLHFCQUFjLEVBQWQsSUFBYztZQUFkLHlCQUFjOztRQUN0QyxJQUFJLFdBQVcsR0FBRyxVQUFRLEdBQUcsZ0JBQWEsQ0FBQztRQUMzQyxJQUFJLE9BQU8sR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDbEMsSUFBRyxLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFDO1lBQ3RCLEtBQUksSUFBSSxDQUFDLEdBQUMsQ0FBQyxFQUFFLENBQUMsR0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFDO2dCQUM1QixJQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUM7b0JBQ3pCLElBQUksR0FBRyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDbEIsSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsSUFBSSxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUM7b0JBQ25ELE9BQU8sQ0FBQyxHQUFHLENBQUksR0FBRyxhQUFRLENBQUMsV0FBTSxNQUFRLENBQUMsQ0FBQztpQkFDOUM7YUFDSjtZQUNELElBQUksTUFBTSxHQUFHLGNBQWMsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQzlDLE9BQU8sTUFBTSxDQUFDO1NBQ2pCO0lBQ0wsQ0FBQyxDQUFBO0lBQ0QsT0FBTyxVQUFVLENBQUM7QUFDdEIsQ0FBQztBQUdEO0lBQWEsY0FBYztTQUFkLFVBQWMsRUFBZCxxQkFBYyxFQUFkLElBQWM7UUFBZCx5QkFBYzs7SUFDdkIsUUFBTyxJQUFJLENBQUMsTUFBTSxFQUFDO1FBQ2YsS0FBSyxDQUFDO1lBQ0YsT0FBTyxRQUFRLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN0QyxLQUFLLENBQUM7WUFDRixXQUFXLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBRSxJQUFJLENBQUMsQ0FBQztZQUM5QixNQUFNO1FBQ1YsS0FBSyxDQUFDO1lBQ0YsSUFBRyxPQUFPLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxRQUFRLEVBQUM7Z0JBQzNCLFlBQVksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO2FBQ2xDO1lBQ0QsT0FBTyxTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN2QztZQUNJLE1BQU0sSUFBSSxLQUFLLENBQUMsZ0NBQWdDLENBQUMsQ0FBQztLQUN6RDtBQUNMLENBQUM7QUFRRDtJQUFBO0lBSUEsQ0FBQztJQUFELGdCQUFDO0FBQUQsQ0FKQSxBQUlDLElBQUE7QUFrQkQ7SUFJSSxnQkFBWSxjQUFzQixFQUFFLFVBQWlCLEVBQUUsSUFBYztRQUNqRSxJQUFJLENBQUMsY0FBYyxHQUFHLGNBQWMsQ0FBQztRQUNyQyxJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztRQUM3QixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztJQUNyQixDQUFDO0lBQ0wsYUFBQztBQUFELENBVEEsQUFTQyxJQUFBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL1RhZyBmdW5jdGlvbjogVXNlciB0byBjdXN0b20gdGVtcGxhdGUgc3RyaW5nIHByb2Nlc3NvclxyXG4vLyBsZXQgc2F5OnN0cmluZyA9ICdhIGJpcmQgaW4gaGFuZCA+IHR3byBpbiB0aGUgYnVzaCc7XHJcbi8vIGxldCBodG1sOmFueSA9IGh0bWxFc2NhcGUgYDxkaXY+IEkgd291bGQganVzdCBsaWtlIHRvIHNheSA6ICR7c2F5fTwvZGl2PmA7XHJcblxyXG4vLyBmdW5jdGlvbiBodG1sRXNjYXBlKGxpdGVyYWxzOiBhbnksIC4uLnBsYWNlaG9sZGVyczphbnlbXSk6IGFueSB7XHJcbi8vICAgICBsZXQgcmVzdWx0OnN0cmluZyA9IFwiXCI7XHJcblxyXG4vLyAgICAgLy8gaW50ZXJsZWF2ZSB0aGUgbGl0ZXJhbHMgd2l0aCB0aGUgcGxhY2Vob2xkZXJzXHJcbi8vICAgICBmb3IgKGxldCBpOm51bWJlciA9IDA7IGkgPCBwbGFjZWhvbGRlcnMubGVuZ3RoOyBpKyspIHtcclxuLy8gICAgICAgICByZXN1bHQgKz0gbGl0ZXJhbHNbaV07XHJcbi8vICAgICAgICAgcmVzdWx0ICs9IHBsYWNlaG9sZGVyc1tpXVxyXG4vLyAgICAgICAgICAgICAucmVwbGFjZSgvJi9nLCAnJmFtcDsnKVxyXG4vLyAgICAgICAgICAgICAucmVwbGFjZSgvXCIvZywgJyZxdW90OycpXHJcbi8vICAgICAgICAgICAgIC5yZXBsYWNlKC8nL2csICcmIzM5OycpXHJcbi8vICAgICAgICAgICAgIC5yZXBsYWNlKC88L2csICcmbHQ7JylcclxuLy8gICAgICAgICAgICAgLnJlcGxhY2UoLz4vZywgJyZndDsnKTtcclxuLy8gICAgIH1cclxuXHJcbi8vICAgICAvLyBhZGQgdGhlIGxhc3QgbGl0ZXJhbFxyXG4vLyAgICAgcmVzdWx0ICs9IGxpdGVyYWxzW2xpdGVyYWxzLmxlbmd0aCAtIDFdO1xyXG4vLyAgICAgcmV0dXJuIHJlc3VsdDtcclxuLy8gfVxyXG4vLyBhbGVydChodG1sKTtcclxuXHJcbi8vSGlnaCBsZXZlbCBmdW5jaXRvblxyXG4vLyBmdW5jdGlvbiBiYXIoY2IgOigpPT52b2lkKXtcclxuLy8gICAgIGNiKCk7XHJcbi8vIH1cclxuXHJcbi8vQXJyb3cgRnVuY3Rpb25cclxuLy8gY2xhc3MgUGVyc29ue1xyXG4vLyAgICAgbmFtZTogc3RyaW5nO1xyXG4vLyAgICAgY29uc3RydWN0b3IobmFtZTpzdHJpbmcpe1xyXG4vLyAgICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbi8vICAgICB9XHJcbi8vICAgICBncmVldCgpe1xyXG4vLyAgICAgICAgIGFsZXJ0KGBIaSEgTXkgbmFtZSBpcyAke3RoaXMubmFtZX1gKTtcclxuLy8gICAgIH1cclxuLy8gICAgIC8vIGdyZWV0RGVsYXkodGltZTogbnVtYmVyKXtcclxuLy8gICAgIC8vICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4vLyAgICAgLy8gICAgICAgICBhbGVydChgSGkhIE15IG5hbWUgaXMgJHt0aGlzLm5hbWV9YCk7IFxyXG4vLyAgICAgLy8gICAgIH0sIHRpbWUpO1xyXG4vLyAgICAgLy8gfSAgXHJcbi8vICAgICBncmVldERlbGF5KHRpbWU6IG51bWJlcil7XHJcbi8vICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7IC8vYmluZCBzY29wZVxyXG4vLyAgICAgICAgICAgICBhbGVydChgSGkhIE15IG5hbWUgaXMgJHt0aGlzLm5hbWV9YCk7IFxyXG4vLyAgICAgICAgIH0sIHRpbWUpO1xyXG4vLyAgICAgfSAgICBcclxuLy8gfVxyXG5cclxuLy8gdmFyIG5ld1Blb3BsZSA9IG5ldyBQZXJzb24oXCJKYXNvblwiKTtcclxuLy8gbmV3UGVvcGxlLmdyZWV0KCk7XHJcbi8vIG5ld1Blb3BsZS5ncmVldERlbGF5KDUwMDApO1xyXG5cclxuLy9Qcm9taXNlXHJcbi8vIC8vLzxyZWZlcmVuY2UgcGF0aD1cIi4uXFwuLlxcdHlwaW5nc1xcZ2xvYmFsc1xcaGFuZGxlYmFyc1xcaW5kZXguZC50c1wiIC8+IFxyXG4vLyBpbXBvcnQgJCBmcm9tIFwianF1ZXJ5XCI7XHJcbi8vIGltcG9ydCAqIGFzIFEgZnJvbSAnUSc7XHJcbi8vaW1wb3J0IHsgVXNlck1vZHVsZSB9IGZyb20gJy4vbW9kdWxlcyc7XHJcbi8vIHR5cGUgY2IgPSAoanNvbjphbnkpID0+IHZvaWQ7XHJcbi8vIGNsYXNzIFZpZXd7XHJcbi8vICAgICBwcml2YXRlIF9jb250YWluZXI6IHN0cmluZztcclxuLy8gICAgIHByaXZhdGUgX3RlbXBsYXRlVXJsOiBzdHJpbmc7XHJcbi8vICAgICBwcml2YXRlIF9zZXJ2aWNlVXJsOiBzdHJpbmc7XHJcbi8vICAgICBwcml2YXRlIF9hcmdzOiBhbnk7XHJcbi8vICAgICBjb25zdHJ1Y3Rvcihjb25maWc6IGFueSl7XHJcbi8vICAgICAgICAgdGhpcy5fY29udGFpbmVyID0gY29uZmlnLmNvbnRhaW5lcjtcclxuLy8gICAgICAgICB0aGlzLl90ZW1wbGF0ZVVybCA9IGNvbmZpZy50ZW1wbGF0ZVVybDtcclxuLy8gICAgICAgICB0aGlzLl9zZXJ2aWNlVXJsID0gY29uZmlnLnNlcnZpY2VVcmw7XHJcbi8vICAgICAgICAgdGhpcy5fYXJncyA9IGNvbmZpZy5hcmdzO1xyXG4vLyAgICAgfVxyXG4vLyAgICAgcHJpdmF0ZSBfbG9hZEpzb24odXJsOiBzdHJpbmcsIGFyZ3M6IGFueSwgY2I6IGNiLCBlcnJvckNiOmNiKXtcclxuLy8gICAgICAgICAkLmFqYXgoe1xyXG4vLyAgICAgICAgICAgICB1cmw6IHVybCxcclxuLy8gICAgICAgICAgICAgdHlwZTogXCJHRVRcIixcclxuLy8gICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4vLyAgICAgICAgICAgICBkYXRhOiBhcmdzLFxyXG4vLyAgICAgICAgICAgICBzdWNjZXNzOiAoanNvbikgPT4ge1xyXG4vLyAgICAgICAgICAgICAgICAgY2IoanNvbik7XHJcbi8vICAgICAgICAgICAgIH0sXHJcbi8vICAgICAgICAgICAgIGVycm9yOiAoZSk9PntcclxuLy8gICAgICAgICAgICAgICAgIGVycm9yQ2IoZSk7XHJcbi8vICAgICAgICAgICAgIH1cclxuLy8gICAgICAgICB9KVxyXG4vLyAgICAgfVxyXG4vLyAgICAgcHJpdmF0ZSBfbG9hZEhicyh1cmw6IHN0cmluZywgY2I6IGNiLCBlcnJvckNiOmNiKXtcclxuLy8gICAgICAgICAkLmFqYXgoe1xyXG4vLyAgICAgICAgICAgICB1cmw6IHVybCxcclxuLy8gICAgICAgICAgICAgdHlwZTogXCJHRVRcIixcclxuLy8gICAgICAgICAgICAgZGF0YVR5cGU6IFwidGV4dFwiLFxyXG4vLyAgICAgICAgICAgICBzdWNjZXNzOiAoaGJzKSA9PiB7XHJcbi8vICAgICAgICAgICAgICAgICBjYihoYnMpO1xyXG4vLyAgICAgICAgICAgICB9LFxyXG4vLyAgICAgICAgICAgICBlcnJvcjogKGUpPT57XHJcbi8vICAgICAgICAgICAgICAgICBlcnJvckNiKGUpO1xyXG4vLyAgICAgICAgICAgICB9XHJcbi8vICAgICAgICAgfSlcclxuLy8gICAgIH1cclxuLy8gICAgIHByaXZhdGUgX2NvbXBpbGVIYnMoaGJzOiBzdHJpbmcsIGNiOiBjYiwgZXJyb3JDYjpjYil7XHJcbi8vICAgICAgICAgdHJ5e1xyXG4vLyAgICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSBIYW5kbGViYXJzLmNvbXBpbGUoaGJzKTtcclxuLy8gICAgICAgICAgICAgY2IodGVtcGxhdGUpO1xyXG4vLyAgICAgICAgIH1jYXRjaChlKXtcclxuLy8gICAgICAgICAgICAgZXJyb3JDYihlKTtcclxuLy8gICAgICAgICB9XHJcbi8vICAgICB9XHJcbi8vICAgICBwcml2YXRlIF9qc29uVG9IdG1sKHRlbXBsYXRlOiBhbnksIGpzb246IGFueSwgY2I6IGNiLCBlcnJvckNiOmNiKXsgICAgICAgIFxyXG4vLyAgICAgICAgIHRyeXtcclxuLy8gICAgICAgICAgICAgdmFyIGh0bWwgPSB0ZW1wbGF0ZShqc29uKTtcclxuLy8gICAgICAgICAgICAgY2IoaHRtbCk7XHJcbi8vICAgICAgICAgfWNhdGNoKGUpe1xyXG4vLyAgICAgICAgICAgICBlcnJvckNiKGUpO1xyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH0gXHJcbi8vICAgICBwcml2YXRlIF9hcHBlbmRIdG1sKGh0bWw6IHN0cmluZywgY2I6IGNiLCBlcnJvckNiOmNiKXtcclxuLy8gICAgICAgICB0cnl7XHJcbi8vICAgICAgICAgICAgIGlmKCQodGhpcy5fY29udGFpbmVyKS5sZW5ndGggPT09IDApe1xyXG4vLyAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ29udGFpbmVyIG5vdCBmb3VuZCFcIik7XHJcbi8vICAgICAgICAgICAgIH1cclxuLy8gICAgICAgICAgICAgJCh0aGlzLl9jb250YWluZXIpLmh0bWwoaHRtbCk7XHJcbi8vICAgICAgICAgICAgIGNiKCQodGhpcy5fY29udGFpbmVyKSk7XHJcbi8vICAgICAgICAgfWNhdGNoKGUpe1xyXG4vLyAgICAgICAgICAgICBlcnJvckNiKGUpO1xyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH1cclxuLy8gICAgIHB1YmxpYyByZW5kZXIoY2I6IGNiLCBlcnJvckNiOiBjYil7XHJcbi8vICAgICAgICAgdHJ5IHtcclxuLy8gICAgICAgICAgICAgdGhpcy5fbG9hZEpzb24odGhpcy5fc2VydmljZVVybCwgdGhpcy5fYXJncywgKGpzb24pPT57XHJcbi8vICAgICAgICAgICAgICAgICB0aGlzLl9sb2FkSGJzKHRoaXMuX3RlbXBsYXRlVXJsLCAoaGJzKT0+e1xyXG4vLyAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbXBpbGVIYnMoaGJzLCAodGVtcGxhdGUpPT57XHJcbi8vICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2pzb25Ub0h0bWwodGVtcGxhdGUsIGpzb24sIChodG1sKT0+e1xyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXBwZW5kSHRtbChodG1sLCBjYiwgZXJyb3JDYik7XHJcbi8vICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGVycm9yQ2IpXHJcbi8vICAgICAgICAgICAgICAgICAgICAgfSwgZXJyb3JDYik7XHJcbi8vICAgICAgICAgICAgICAgICB9LCBlcnJvckNiKTtcclxuLy8gICAgICAgICAgICAgfSwgZXJyb3JDYik7XHJcbi8vICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4vLyAgICAgICAgICAgICBlcnJvckNiKGUpO1xyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH1cclxuLy8gfVxyXG5cclxuLy8gY2xhc3MgVmlld0FzeW5je1xyXG4vLyAgICAgcHJpdmF0ZSBfY29udGFpbmVyOiBzdHJpbmc7XHJcbi8vICAgICBwcml2YXRlIF90ZW1wbGF0ZVVybDogc3RyaW5nO1xyXG4vLyAgICAgcHJpdmF0ZSBfc2VydmljZVVybDogc3RyaW5nO1xyXG4vLyAgICAgcHJpdmF0ZSBfYXJnczogYW55O1xyXG4vLyAgICAgY29uc3RydWN0b3IoY29uZmlnOiBhbnkpe1xyXG4vLyAgICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbmZpZy5jb250YWluZXI7XHJcbi8vICAgICAgICAgdGhpcy5fdGVtcGxhdGVVcmwgPSBjb25maWcudGVtcGxhdGVVcmw7XHJcbi8vICAgICAgICAgdGhpcy5fc2VydmljZVVybCA9IGNvbmZpZy5zZXJ2aWNlVXJsO1xyXG4vLyAgICAgICAgIHRoaXMuX2FyZ3MgPSBjb25maWcuYXJncztcclxuLy8gICAgIH1cclxuLy8gICAgIHByaXZhdGUgX2xvYWRKc29uQXN5bmModXJsOiBzdHJpbmcsIGFyZ3M6IGFueSl7XHJcbi8vICAgICAgICAgcmV0dXJuIFEuUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xyXG4vLyAgICAgICAgICAgICAkLmFqYXgoe1xyXG4vLyAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXHJcbi8vICAgICAgICAgICAgICAgICB0eXBlOiBcIkdFVFwiLFxyXG4vLyAgICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4vLyAgICAgICAgICAgICAgICAgZGF0YTogYXJncyxcclxuLy8gICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IChqc29uKSA9PiB7XHJcbi8vICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShqc29uKTtcclxuLy8gICAgICAgICAgICAgICAgIH0sXHJcbi8vICAgICAgICAgICAgICAgICBlcnJvcjogKGUpPT57XHJcbi8vICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4vLyAgICAgICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgICAgICB9KTtcclxuLy8gICAgICAgICB9KTtcclxuLy8gICAgIH1cclxuLy8gICAgIHByaXZhdGUgX2xvYWRIYnNBc3luYyh1cmw6IHN0cmluZyl7XHJcbi8vICAgICAgICAgcmV0dXJuIFEuUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xyXG4vLyAgICAgICAgICAgICAkLmFqYXgoe1xyXG4vLyAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXHJcbi8vICAgICAgICAgICAgICAgICB0eXBlOiBcIkdFVFwiLFxyXG4vLyAgICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwidGV4dFwiLFxyXG4vLyAgICAgICAgICAgICAgICAgc3VjY2VzczogKGhicykgPT4ge1xyXG4vLyAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoaGJzKTtcclxuLy8gICAgICAgICAgICAgICAgIH0sXHJcbi8vICAgICAgICAgICAgICAgICBlcnJvcjogKGUpPT57XHJcbi8vICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4vLyAgICAgICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgICAgICB9KTtcclxuLy8gICAgICAgICB9KTtcclxuXHJcbi8vICAgICB9XHJcbi8vICAgICBwcml2YXRlIF9jb21waWxlSGJzQXN5bmMoaGJzOiBzdHJpbmcpe1xyXG4vLyAgICAgICAgIHJldHVybiBRLlByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcclxuLy8gICAgICAgICAgICAgdHJ5e1xyXG4vLyAgICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gSGFuZGxlYmFycy5jb21waWxlKGhicyk7XHJcbi8vICAgICAgICAgICAgICAgICByZXNvbHZlKHRlbXBsYXRlKTtcclxuLy8gICAgICAgICAgICAgfWNhdGNoKGUpe1xyXG4vLyAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4vLyAgICAgICAgICAgICB9XHJcbi8vICAgICAgICAgfSk7ICAgIFxyXG5cclxuLy8gICAgIH1cclxuLy8gICAgIHByaXZhdGUgX2pzb25Ub0h0bWxBc3luYyh0ZW1wbGF0ZTogYW55LCBqc29uOiBhbnkpe1xyXG4vLyAgICAgICAgIHJldHVybiBRLlByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcclxuLy8gICAgICAgICAgICAgdHJ5e1xyXG4vLyAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSB0ZW1wbGF0ZShqc29uKTtcclxuLy8gICAgICAgICAgICAgICAgIHJlc29sdmUoaHRtbCk7XHJcbi8vICAgICAgICAgICAgIH1jYXRjaChlKXtcclxuLy8gICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuLy8gICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgIH0pOyAgICAgICAgICAgICAgICAgXHJcbi8vICAgICB9IFxyXG4vLyAgICAgcHJpdmF0ZSBfYXBwZW5kSHRtbEFzeW5jKGh0bWw6IHN0cmluZywgY29udGFpbmVyOiBzdHJpbmcpe1xyXG4vLyAgICAgICAgIHJldHVybiBRLlByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcclxuLy8gICAgICAgICAgICAgdHJ5e1xyXG4vLyAgICAgICAgICAgICAgICAgdmFyICRjb250YWluZXI6IGFueSA9ICQoY29udGFpbmVyKTtcclxuLy8gICAgICAgICAgICAgICAgIGlmKCRjb250YWluZXIubGVuZ3RoID09PSAwKXtcclxuLy8gICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb250YWluZXIgbm90IGZvdW5kIVwiKTtcclxuLy8gICAgICAgICAgICAgICAgIH1cclxuLy8gICAgICAgICAgICAgICAgICRjb250YWluZXIuaHRtbChodG1sKTtcclxuLy8gICAgICAgICAgICAgICAgIHJlc29sdmUoJGNvbnRhaW5lcik7XHJcbi8vICAgICAgICAgICAgIH1jYXRjaChlKXtcclxuLy8gICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuLy8gICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgIH0pOyAgICAgXHJcblxyXG4vLyAgICAgfVxyXG4vLyAgICAgcHVibGljIHJlbmRlckFzeW5jKCl7XHJcbi8vICAgICAgICAgcmV0dXJuIFEuUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KT0+e1xyXG4vLyAgICAgICAgICAgICB0cnl7XHJcbi8vICAgICAgICAgICAgICAgICB2YXIgZ2V0SnNvbiA9IHRoaXMuX2xvYWRKc29uQXN5bmModGhpcy5fc2VydmljZVVybCwgdGhpcy5fYXJncyk7XHJcbi8vICAgICAgICAgICAgICAgICB2YXIgZ2V0VGVtcGxhdGUgPSB0aGlzLl9sb2FkSGJzQXN5bmModGhpcy5fdGVtcGxhdGVVcmwpLnRoZW4odGhpcy5fY29tcGlsZUhic0FzeW5jKTtcclxuLy8gICAgICAgICAgICAgICAgIFEuYWxsKFsnZ2V0SnNvbicsICdnZXRUZW1wbGF0ZSddKS50aGVuKChyZXN1bHRzKT0+e1xyXG4vLyAgICAgICAgICAgICAgICAgICAgIHZhciBqc29uID0gcmVzdWx0c1swXTtcclxuLy8gICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSByZXN1bHRzWzFdO1xyXG4vLyAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2pzb25Ub0h0bWxBc3luYyh0ZW1wbGF0ZSwganNvbilcclxuLy8gICAgICAgICAgICAgICAgICAgICAudGhlbigoaHRtbDpzdHJpbmcpPT57XHJcbi8vICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcHBlbmRIdG1sQXN5bmMoaHRtbCwgdGhpcy5fY29udGFpbmVyKVxyXG4vLyAgICAgICAgICAgICAgICAgICAgIH0pXHJcbi8vICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCRjb250YWluZXI6IGFueSk9PntcclxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgkY29udGFpbmVyKTtcclxuLy8gICAgICAgICAgICAgICAgICAgICB9KTtcclxuLy8gICAgICAgICAgICAgICAgIH0pXHJcbi8vICAgICAgICAgICAgIH1jYXRjaChlKXtcclxuLy8gICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuLy8gICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgIH0pOyAgICAgICAgICBcclxuLy8gICAgIH1cclxuLy8gfVxyXG5cclxuLy8gZnVuY3Rpb24gKmZvbygpe1xyXG4vLyAgICAgeWllbGQgMTtcclxuLy8gICAgIHlpZWxkIDI7XHJcbi8vICAgICB5aWVsZCAzO1xyXG4vLyAgICAgeWllbGQgNDtcclxuLy8gICAgIHJldHVybiA1O1xyXG4vLyB9XHJcblxyXG4vLyB2YXIgYmFyID0gbmV3IGZvbygpO1xyXG4vLyBiYXIubmV4dCgpO1xyXG4vLyBiYXIubmV4dCgpO1xyXG4vLyBiYXIubmV4dCgpO1xyXG4vLyBiYXIubmV4dCgpO1xyXG4vLyBiYXIubmV4dCgpO1xyXG4vLyBiYXIubmV4dCgpO1xyXG5cclxuLy8gdmFyIHA6IFByb21pc2U8bnVtYmVyPjtcclxuLy8gYXN5bmMgZnVuY2l0b24gZm4oKTogUHJvbWlzZTxudW1iZXI+e1xyXG4vLyAgICAgdmFyIGkgPSBhd2FpdCBwO1xyXG4vLyAgICAgcmV0dXJuIDEgKyBpO1xyXG4vLyB9XHJcblxyXG4vL1Byb21pc2VcclxuLy8vLy88cmVmZXJlbmNlIHBhdGg9XCIuLlxcLi5cXHR5cGluZ3NcXG1vZHVsZXNcXHFcXGluZGV4LmQudHNcIiAvPiBcclxuXHJcblxyXG4vLyBjbGFzcyBOb3RHZW5lcmljVXNlclJlcG9zaXRvcnl7XHJcbi8vICAgICBwcml2YXRlIF91cmw6IHN0cmluZztcclxuLy8gICAgIGNvbnN0cnVjdG9yKHVybDogc3RyaW5nKXtcclxuLy8gICAgICAgICB0aGlzLl91cmwgPSB1cmw7XHJcbi8vICAgICB9XHJcblxyXG4vLyAgICAgcHVibGljIGdldEFzeW5jKCl7XHJcbi8vICAgICAgICAgcmV0dXJuIFEuUHJvbWlzZSgocmVzb2x2ZTogKHVzZXJzOiBVc2VyW10pID0+IHZvaWQsIHJlamVjdCk9PntcclxuLy8gICAgICAgICAgICAgJC5hamF4KHtcclxuLy8gICAgICAgICAgICAgICAgIHVybDogdGhpcy5fdXJsLFxyXG4vLyAgICAgICAgICAgICAgICAgdHlwZTogXCJHRVRcIixcclxuLy8gICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuLy8gICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IChkYXRhKT0+e1xyXG4vLyAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VycyA9IDxVc2VyW10+ZGF0YS5pdGVtcztcclxuLy8gICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHVzZXJzKTtcclxuLy8gICAgICAgICAgICAgICAgIH0sXHJcbi8vICAgICAgICAgICAgICAgICBlcnJvcjogKGUpPT57XHJcbi8vICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4vLyAgICAgICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgICAgICB9KTtcclxuLy8gICAgICAgICB9KTtcclxuLy8gICAgIH1cclxuLy8gfVxyXG5cclxuLy8gY2xhc3MgTm90R2VuZXJpY1RhbGtSZXBvc2l0b3J5e1xyXG4vLyAgICAgcHJpdmF0ZSBfdXJsOiBzdHJpbmc7XHJcbi8vICAgICBjb25zdHJ1Y3Rvcih1cmw6IHN0cmluZyl7XHJcbi8vICAgICAgICAgdGhpcy5fdXJsID0gdXJsO1xyXG4vLyAgICAgfVxyXG5cclxuLy8gICAgIHB1YmxpYyBnZXRBc3luYygpe1xyXG4vLyAgICAgICAgIHJldHVybiBRLlByb21pc2UoKHJlc29sdmU6ICh1c2VyczogVGFsa1tdKSA9PiB2b2lkLCByZWplY3QpPT57XHJcbi8vICAgICAgICAgICAgICQuYWpheCh7XHJcbi8vICAgICAgICAgICAgICAgICB1cmw6IHRoaXMuX3VybCxcclxuLy8gICAgICAgICAgICAgICAgIHR5cGU6IFwiR0VUXCIsXHJcbi8vICAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbi8vICAgICAgICAgICAgICAgICBzdWNjZXNzOiAoZGF0YSk9PntcclxuLy8gICAgICAgICAgICAgICAgICAgICB2YXIgdGFsa3MgPSA8VGFsa1tdPmRhdGEuaXRlbXM7XHJcbi8vICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0YWxrcyk7XHJcbi8vICAgICAgICAgICAgICAgICB9LFxyXG4vLyAgICAgICAgICAgICAgICAgZXJyb3I6IChlKT0+e1xyXG4vLyAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuLy8gICAgICAgICAgICAgICAgIH1cclxuLy8gICAgICAgICAgICAgfSk7XHJcbi8vICAgICAgICAgfSk7XHJcbi8vICAgICB9ICAgIFxyXG4vLyB9XHJcblxyXG4vLyBjbGFzcyBVc2VyIGltcGxlbWVudHMgVmFsaWRhdGFibGVJbnRlcmZhY2V7XHJcbi8vICAgICBwdWJsaWMgbmFtZTogc3RyaW5nO1xyXG4vLyAgICAgcHVibGljIHBhc3N3b3JkOiBzdHJpbmc7XHJcbi8vICAgICBwdWJsaWMgaXNWYWxpZCgpOiBib29sZWFue1xyXG4vLyAgICAgICAgIHJldHVybiB0cnVlO1xyXG4vLyAgICAgfVxyXG4vLyB9XHJcblxyXG4vLyBjbGFzcyBUYWxrIGltcGxlbWVudHMgVmFsaWRhdGFibGVJbnRlcmZhY2V7XHJcbi8vICAgICBwdWJsaWMgdGl0bGU6IHN0cmluZztcclxuLy8gICAgIHB1YmxpYyBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4vLyAgICAgcHVibGljIGxhbmd1YWdlOiBzdHJpbmc7XHJcbi8vICAgICBwdWJsaWMgdXJsOiBzdHJpbmc7XHJcbi8vICAgICBwdWJsaWMgeWVhcjogc3RyaW5nO1xyXG4vLyAgICAgcHVibGljIGlzVmFsaWQoKTogYm9vbGVhbntcclxuLy8gICAgICAgICByZXR1cm4gdHJ1ZTtcclxuLy8gICAgIH0gICAgXHJcbi8vIH1cclxuXHJcbi8vIGludGVyZmFjZSBWYWxpZGF0YWJsZUludGVyZmFjZXtcclxuLy8gICAgIGlzVmFsaWQoKTogYm9vbGVhbjtcclxuLy8gfVxyXG5cclxuLy8gY2xhc3MgR2VuZXJpY1JlcG9zaXRvcnk8VCBleHRlbmRzIFZhbGlkYXRhYmxlSW50ZXJmYWNlPntcclxuLy8gICAgIHByaXZhdGUgX3VybDogc3RyaW5nO1xyXG4vLyAgICAgY29uc3RydWN0b3IodXJsOiBzdHJpbmcpe1xyXG4vLyAgICAgICAgIHRoaXMuX3VybCA9IHVybDtcclxuLy8gICAgIH1cclxuXHJcbi8vICAgICBwdWJsaWMgZ2V0QXN5bmMoKXtcclxuLy8gICAgICAgICByZXR1cm4gUS5Qcm9taXNlKChyZXNvbHZlOiAodXNlcnM6IFRbXSkgPT4gdm9pZCwgcmVqZWN0KT0+e1xyXG4vLyAgICAgICAgICAgICAkLmFqYXgoe1xyXG4vLyAgICAgICAgICAgICAgICAgdXJsOiB0aGlzLl91cmwsXHJcbi8vICAgICAgICAgICAgICAgICB0eXBlOiBcIkdFVFwiLFxyXG4vLyAgICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4vLyAgICAgICAgICAgICAgICAgc3VjY2VzczogKGRhdGEpPT57XHJcbi8vICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1zID0gPFRbXT5kYXRhLml0ZW1zO1xyXG4vLyAgICAgICAgICAgICAgICAgICAgIHZhciBsaXN0cyA9IDxUW10+W107XHJcbi8vICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7IGk8IGl0ZW1zLmxlbmd0aDsgaSsrKXtcclxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgaWYoaXRlbXNbaV0uaXNWYWxpZCgpKXtcclxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RzLnB1c2goaXRlbXNbaV0pO1xyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbi8vICAgICAgICAgICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUobGlzdHMpO1xyXG4vLyAgICAgICAgICAgICAgICAgfSxcclxuLy8gICAgICAgICAgICAgICAgIGVycm9yOiAoZSk9PntcclxuLy8gICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XHJcbi8vICAgICAgICAgICAgICAgICB9XHJcbi8vICAgICAgICAgICAgIH0pO1xyXG4vLyAgICAgICAgIH0pO1xyXG4vLyAgICAgfSAgICBcclxuLy8gfVxyXG5cclxuLy8gdmFyIHVzZXJSZXBvc2l0b3J5ID0gbmV3IEdlbmVyaWNSZXBvc2l0b3J5PFVzZXI+KFwiLi9kZW1vcy9zaGFyZWQvdXNlcnMuanNvblwiKTtcclxuLy8gdXNlclJlcG9zaXRvcnkuZ2V0QXN5bmMoKS50aGVuKGZ1bmN0aW9uKHVzZXJzOiBVc2VyW10pe1xyXG4vLyAgICAgY29uc29sZS5sb2coJ25vdEdlbmVyaWNVc2VyUmVwb3NpdG9yeSA9PicsIHVzZXJzKTtcclxuLy8gfSk7XHJcblxyXG4vLyB2YXIgdGFsa1JlcG9zaXRvcnkgPSBuZXcgR2VuZXJpY1JlcG9zaXRvcnk8VGFsaz4oXCIuL2RlbW9zL3NoYXJlZC90YWxrcy5qc29uXCIpO1xyXG4vLyB0YWxrUmVwb3NpdG9yeS5nZXRBc3luYygpLnRoZW4oZnVuY3Rpb24odGFsa3M6IFRhbGtbXSl7XHJcbi8vICAgICBjb25zb2xlLmxvZygnbm90R2VuZXJpY1VzZXJSZXBvc2l0b3J5ID0+JywgdGFsa3MpO1xyXG4vLyB9KTtcclxuXHJcbi8vIGludGVyZmFjZSBJTXlJbnRlcmZhY2V7XHJcbi8vICAgICBkb1NvbWVUaGluZzogKCk9Pnt9XHJcbi8vIH1cclxuXHJcbi8vIGludGVyZmFjZSBJTXlTZWNvbmRJbnRlcmZhY2V7XHJcbi8vICAgICBkb1NvbWVUaGluZ0Vsc2U6ICgpPT57fVxyXG4vLyB9XHJcblxyXG4vLyBpbnRlcmZhY2UgSUNoaWxkSW50ZXJmYWNlIGV4dGVuZHMgSU15SW50ZXJmYWNlLCBJTXlTZWNvbmRJbnRlcmZhY2V7XHJcblxyXG4vLyB9XHJcblxyXG4vLyBjbGFzcyBFeGFtcGxlPFQgZXh0ZW5kcyBJQ2hpbGRJbnRlcmZhY2U+e1xyXG4vLyAgICAgcHJpdmF0ZSBnZW5lcmljUHJvcGVydHk6IFQ7XHJcbi8vICAgICB1c2VyVCgpe1xyXG4vLyAgICAgICAgIHRoaXMuZ2VuZXJpY1Byb3BlcnR5LmRvU29tZVRoaW5nKCk7XHJcbi8vICAgICAgICAgdGhpcy5nZW5lcmljUHJvcGVydHkuZG9Tb21lVGhpbmdFbHNlKCk7XHJcbi8vICAgICB9XHJcbi8vIH1cclxuXHJcbi8vIC8vIGZ1bmN0aW9uIGZhY3RvcnlOb3RXb3JraW5nPFQ+KCk6VHtcclxuLy8gLy8gICAgIHJldHVybiBuZXcgVCgpO1xyXG4vLyAvLyB9XHJcblxyXG4vLyBmdW5jdGlvbiBmYWN0b3J5PFQ+KCk6VHtcclxuLy8gICAgIHZhciB0eXBlOiB7bmV3KCk6IFQ7fVxyXG4vLyAgICAgcmV0dXJuIG5ldyB0eXBlKCk7XHJcbi8vIH1cclxuXHJcbi8vIC8vIHZhciBub3RHZW5lcmljVXNlclJlcG9zaXRvcnkgPSBuZXcgTm90R2VuZXJpY1VzZXJSZXBvc2l0b3J5KFwiLi9kZW1vcy9zaGFyZWQvdXNlcnMuanNvblwiKTtcclxuLy8gLy8gbm90R2VuZXJpY1VzZXJSZXBvc2l0b3J5LmdldEFzeW5jKCkudGhlbihmdW5jdGlvbih1c2VyczogVXNlcltdKXtcclxuLy8gLy8gICAgIGNvbnNvbGUubG9nKCdub3RHZW5lcmljVXNlclJlcG9zaXRvcnkgPT4nLCB1c2Vycyk7XHJcbi8vIC8vIH0pO1xyXG5cclxuLy8gaW50ZXJmYWNlIFBlcnNpc3RhbmNlU2VydmljZUludGVyZmFjZXtcclxuLy8gICAgIHNhdmUoZW50aXR5OiBhbnkpOiBudW1iZXI7XHJcbi8vIH1cclxuXHJcbi8vIGNsYXNzIENvb2tpZVBlcnNpc3RhbmNlU2VydmljZSBpbXBsZW1lbnRzIFBlcnNpc3RhbmNlU2VydmljZUludGVyZmFjZXtcclxuLy8gICAgIHNhdmUoZW50aXR5OiBhbnkpOiBudW1iZXJ7XHJcbi8vICAgICAgICAgdmFyIGlkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwICsgMSk7XHJcbi8vICAgICAgICAgcmV0dXJuIGlkO1xyXG4vLyAgICAgfVxyXG4vLyB9XHJcblxyXG4vLyBjbGFzcyBMb2NhbFN0b3JhZ2VQZXJzaXN0YW5jZVNlcnZpY2UgaW1wbGVtZW50cyBQZXJzaXN0YW5jZVNlcnZpY2VJbnRlcmZhY2V7XHJcbi8vICAgICBzYXZlKGVudGl0eTogYW55KTogbnVtYmVye1xyXG4vLyAgICAgICAgIHZhciBpZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCArIDEpO1xyXG4vLyAgICAgICAgIHJldHVybiBpZDtcclxuLy8gICAgIH1cclxuLy8gfVxyXG4vLyAvL+S4gOS4quaWueazleW6lOivpeS+nei1luS6juaKveixoeiAjOS4jeaYr+S4gOS4quWunuS+i1xyXG4vLyBjbGFzcyBGYXZvdXJpdGVzQ29udHJvbGxlcntcclxuLy8gICAgIHByaXZhdGUgX3BlcnNpc3RhbmNlU2VydmljZTogUGVyc2lzdGFuY2VTZXJ2aWNlSW50ZXJmYWNlO1xyXG4vLyAgICAgY29uc3RydWN0b3IocGVyc2lzdGFuY2VTZXJ2aWNlOiBQZXJzaXN0YW5jZVNlcnZpY2VJbnRlcmZhY2Upe1xyXG4vLyAgICAgICAgIHRoaXMuX3BlcnNpc3RhbmNlU2VydmljZSA9IHBlcnNpc3RhbmNlU2VydmljZTtcclxuLy8gICAgIH1cclxuLy8gICAgIHB1YmxpYyBzYXZlQXNGYXZvdXJpdGUoYXJ0aWNsZUlkOiBudW1iZXIpe1xyXG4vLyAgICAgICAgIHJldHVybiB0aGlzLl9wZXJzaXN0YW5jZVNlcnZpY2Uuc2F2ZShhcnRpY2xlSWQpO1xyXG4vLyAgICAgfVxyXG4vLyB9XHJcblxyXG4vLyB2YXIgZmF2Q29udHJvbGxlciA9IG5ldyBGYXZvdXJpdGVzQ29udHJvbGxlcihuZXcgQ29va2llUGVyc2lzdGFuY2VTZXJ2aWNlKCkpO1xyXG4vLyB2YXIgZmF2Q29udHJvbGxlciA9IG5ldyBGYXZvdXJpdGVzQ29udHJvbGxlcihuZXcgTG9jYWxTdG9yYWdlUGVyc2lzdGFuY2VTZXJ2aWNlKCkpO1xyXG5cclxuLy8gaW50ZXJmYWNlIFZlaGljbGVJbnRlcmZhY2V7XHJcbi8vICAgICBnZXRTcGVlZCgpOiBudW1iZXI7XHJcbi8vICAgICBnZXRWZWhpY2xlVHlwZTogc3RyaW5nO1xyXG4vLyAgICAgaXNUYXhQYXllZChjYXJJZDogc3RyaW5nKTpib29sZWFuO1xyXG4vLyB9XHJcblxyXG4vLyBpbnRlcmZhY2UgQ291bnRlciB7XHJcbi8vICAgICAoc3RhcnQ6IG51bWJlcik6IHN0cmluZztcclxuLy8gICAgIGludGVydmFsOiBudW1iZXI7XHJcbi8vICAgICByZXNldCgpOiB2b2lkO1xyXG4vLyB9XHJcblxyXG4vLyAvL0h5YnJpZCBUeXBlc1xyXG4vLyBmdW5jdGlvbiBnZXRDb3VudGVyKCk6IENvdW50ZXIge1xyXG4vLyAgICAgbGV0IGNvdW50ZXIgPSA8Q291bnRlcj5mdW5jdGlvbihzdGFydDogbnVtYmVyKXt9O1xyXG4vLyAgICAgY291bnRlci5pbnRlcnZhbCA9IDEyMztcclxuLy8gICAgIGNvdW50ZXIucmVzZXQgPSBmdW5jdGlvbiAoKSB7IH07ICAgIFxyXG4vLyAgICAgcmV0dXJuIGNvdW50ZXI7XHJcbi8vIH1cclxuXHJcbi8vIGxldCBjID0gZ2V0Q291bnRlcigpO1xyXG4vLyBjKDEwKTtcclxuLy8gYy5yZXNldCgpO1xyXG4vLyBjLmludGVydmFsID0gNS4wO1xyXG5cclxuLy8gLy9cclxuLy8gY2xhc3MgQ29udHJvbCB7XHJcbi8vICAgICBzdGF0ZTogYW55O1xyXG4vLyB9XHJcblxyXG4vLyBpbnRlcmZhY2UgU2VsZWN0YWJsZUNvbnRyb2wgZXh0ZW5kcyBDb250cm9sIHtcclxuLy8gICAgIHNlbGVjdCgpOiB2b2lkO1xyXG4vLyB9XHJcblxyXG4vLyBjbGFzcyBCdXR0b24gZXh0ZW5kcyBDb250cm9sIGltcGxlbWVudHMgU2VsZWN0YWJsZUNvbnRyb2wge1xyXG4vLyAgICAgc2VsZWN0KCkgeyB9XHJcbi8vIH1cclxuXHJcbi8vIGNsYXNzIFRleHRCb3ggZXh0ZW5kcyBDb250cm9sIHtcclxuLy8gICAgIHNlbGVjdCgpIHsgfVxyXG4vLyB9XHJcblxyXG4vLyBjbGFzcyBJbWFnZVRlc3QgaW1wbGVtZW50cyBTZWxlY3RhYmxlQ29udHJvbCB7XHJcbi8vICAgICBzdGF0ZTogYW55O1xyXG4vLyAgICAgc2VsZWN0KCkgeyB9XHJcbi8vIH1cclxuLy8gaW1wb3J0IFRlc3RVc2VyTW9kdWxlID0gYXBwLm1vZHVsZS5Vc2VyTW9kdWxlO1xyXG4vLyB2YXIgdXNlciA9IG5ldyBUZXN0VXNlck1vZHVsZSgpO1xyXG5cclxuLy8gaW1wb3J0IHtVc2VyVmFsaWRhdG9yLCBUYWxrVmFsaWRhdG9yfSBmcm9tICcuL3ZhbGlkYXRpb24nO1xyXG5cclxuLy8gY2xhc3MgTWF0aDF7XHJcbi8vICAgICBwdWJsaWMgc3RhdGljIHBvdyhiYXNlOiBudW1iZXIsIGV4cG9uZW50OiBudW1iZXIpe1xyXG4vLyAgICAgICAgIHZhciByZXN1bHQgPSBiYXNlO1xyXG4vLyAgICAgICAgIGZvcih2YXIgaT0xOyBpPGV4cG9uZW50OyBpKyspe1xyXG4vLyAgICAgICAgICAgICByZXN1bHQgKj0gcmVzdWx0KmJhc2U7XHJcbi8vICAgICAgICAgfVxyXG4vLyAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbi8vICAgICB9XHJcbi8vIH1cclxuXHJcbi8vVHlwZXNjcmlwdCBcclxuLy8vPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vbm9kZV9tb2R1bGVzL3JlZmxlY3QtbWV0YWRhdGEvaW5kZXguZC50c1wiIC8+IFxyXG5pbXBvcnQgJ3JlZmxlY3QtbWV0YWRhdGEnO1xyXG5cclxuZnVuY3Rpb24gbG9nVHlwZSh0YXJnZXQ6IGFueSwga2V5OiBzdHJpbmcpe1xyXG4gICAgdmFyIHQgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdkZXNpZ246dHlwZScsIHRhcmdldCwga2V5KTtcclxuICAgIGNvbnNvbGUubG9nKGAke2tleX0gdHlwZTogJHt0Lm5hbWV9YCk7XHJcbn1cclxuXHJcbkBsb2dcclxuY2xhc3MgUGVyc29ue1xyXG4gICAgQGxvZ1xyXG4gICAgcHVibGljIG5hbWU6IHN0cmluZztcclxuICAgIHB1YmxpYyBzdXJuYW1lOiBzdHJpbmc7XHJcbiAgICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcsIHN1cm5hbWU6IHN0cmluZyl7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLnN1cm5hbWUgPSBzdXJuYW1lO1xyXG4gICAgfVxyXG4gICAgQGxvZ1R5cGVcclxuICAgIHB1YmxpYyBzYXlTb21ldGhpbmcoQGxvZyBzb21ldGhpbmc6IHN0cmluZyk6c3RyaW5ne1xyXG4gICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAnJyArIHRoaXMuc3VybmFtZSArIHNvbWV0aGluZztcclxuICAgIH1cclxufVxyXG4gXHJcbi8vQ2xhc3MgZGVjb3JhdG9yXHJcbi8vVXNlIHRvIG1vZGlmeSB0aGUgY2xhc3MgY29udHJ1Y3RvciBmdW5jdGlvblxyXG4vL+aehOmAoOWZqOmAmui/h+i/lOWbnuS4gOS4quaWsOeahOaehOmAoOWHveaVsO+8jOimhuebluWOn+acieeahOaehOmAoOWHveaVsO+8jOS7juiAjOWunueOsOW/q+mAn+S/ruaUueS4gOS4quexu+eahOaehOmAoOWHveaVsOeahOWKn+iDve+8jOi/meS4nOilv+ehruWunuWlveWVilxyXG5mdW5jdGlvbiBsb2dDbGFzcyh0YXJnZXQ6IGFueSl7XHJcbiAgICB2YXIgb3JpZ2luYWwgPSB0YXJnZXQ7IC8v5L+d5a2Y5Y6f5pyJ5p6E6YCg5Ye95pWw55qE5byV55SoXHJcbiAgICAvL+eUqOS6jueUn+aIkOexu+eahOWunuS+i+eahOW3peWFt+aWueazlVxyXG4gICAgZnVuY3Rpb24gY29uc3RydWN0KGNvbnN0cnVjdG9yLCBhcmdzKXsgXHJcbiAgICAgICAgdmFyIGM6IGFueSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHJldHVybiBjb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBhcmdzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYy5wcm90b3R5cGUgPSBjb25zdHJ1Y3Rvci5wcm90b3R5cGU7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBjKCk7XHJcbiAgICB9XHJcbiAgICAvL+aWsOeahOaehOmAoOWHveaVsOihjOS4ulxyXG4gICAgLy/mlrDnmoTmnoTpgKDlh73mlbDlrp7njrDkuobovpPlh7pjb25zb2xl55qE6KGM5Li6XHJcbiAgICB2YXIgZjphbnkgPSBmdW5jdGlvbiguLi5hcmdzKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIk5ldzpcIiArIG9yaWdpbmFsLm5hbWUpO1xyXG4gICAgICAgIHJldHVybiBjb25zdHJ1Y3Qob3JpZ2luYWwsIGFyZ3MpO1xyXG4gICAgfVxyXG4gICAgLy/lpI3liLbljp/lnosg5L2/5b6XaW5zdGFuY2VvZuWHveaVsOiDveWkn+ato+W4uOW3peS9nFxyXG4gICAgZi5wcm90b3R5cGUgPSBvcmlnaW5hbC5wcm90b3R5cGU7XHJcbiAgICByZXR1cm4gZjtcclxufVxyXG5cclxudmFyIG1lID0gbmV3IFBlcnNvbignSmFzb24nLCAnWmhhbmcnKTtcclxubWUuc2F5U29tZXRoaW5nKCdIZWxsbycpO1xyXG5cclxuLy9NZXRob2QgZGVjb3JhdG9yXHJcbmZ1bmN0aW9uIGxvZ01ldGhvZCh0YXJnZXQ6IGFueSwga2V5OiBzdHJpbmcsIGRlc2NyaXB0b3I6IGFueSl7XHJcbiAgICB2YXIgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xyXG4gICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uKC4uLmFyZ3M6IGFueVtdKXtcclxuICAgICAgICB2YXIgYSA9IGFyZ3MubWFwKGEgPT4gSlNPTi5zdHJpbmdpZnkoYSkpLmpvaW4oKTtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gb3JpZ2luYWxNZXRob2QuYXBwbHkodGhpcywgYXJncyk7XHJcbiAgICAgICAgdmFyIHIgPSBKU09OLnN0cmluZ2lmeShyZXN1bHQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBDYWxsOiR7a2V5fSgke2F9KT0+JHtyfWApO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGVzY3JpcHRvcjtcclxufVxyXG5cclxuXHJcbi8vUHJvcGVydHkgZGVjb3JhdG9yXHJcbmZ1bmN0aW9uIGxvZ1Byb3BlcnR5KHRhcmdldDogYW55LCBrZXk6IHN0cmluZyl7XHJcbiAgICB2YXIgX3ZhbCA9IHRoaXNba2V5XTtcclxuICAgIHZhciBnZXR0ZXIgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBHZXQ6ICR7a2V5fSA9PiAke192YWx9YCk7XHJcbiAgICAgICAgcmV0dXJuIF92YWw7XHJcbiAgICB9XHJcbiAgICB2YXIgc2V0dGVyID0gZnVuY3Rpb24obmV3VmFsKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhgU2V0OiAke2tleX0gPT4gJHtuZXdWYWx9YCk7XHJcbiAgICAgICAgX3ZhbCA9IG5ld1ZhbDtcclxuICAgIH1cclxuXHJcbiAgICBpZihkZWxldGUgdGhpc1trZXldKXtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHtcclxuICAgICAgICAgICAgZ2V0OiBnZXR0ZXIsXHJcbiAgICAgICAgICAgIHNldDogc2V0dGVyLFxyXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5cclxuLy9QYXJhbWV0ZXIgZGVjb3JhdG9yXHJcbmZ1bmN0aW9uIGxvZ1BhcmFtZXRlcih0YXJnZXQ6IGFueSwga2V5OiBzdHJpbmcsIGluZGV4OiBudW1iZXIpe1xyXG4gICAgdmFyIG1ldGFkYXRhS2V5ID0gYF9sb2dfJHtrZXl9X3BhcmFtZXRlcnNgO1xyXG4gICAgaWYoQXJyYXkuaXNBcnJheSh0YXJnZXRbbWV0YWRhdGFLZXldKSl7XHJcbiAgICAgICAgdGFyZ2V0W21ldGFkYXRhS2V5XS5wdXNoKGluZGV4KTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIHRhcmdldFttZXRhZGF0YUtleV0gPSBbaW5kZXhdO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiByZWFkTWV0YWRhdGEodGFyZ2V0OiBhbnksIGtleTogc3RyaW5nLCBkZXNjcmlwdG9yOiBhbnkpe1xyXG4gICAgdmFyIG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcclxuICAgIGRlc2NyaXB0b3IudmFsdWUgPSBmdW5jdGlvbiguLi5hcmdzOiBhbnlbXSl7XHJcbiAgICAgICAgdmFyIG1ldGFkYXRhS2V5ID0gYF9sb2dfJHtrZXl9X3BhcmFtZXRlcnNgO1xyXG4gICAgICAgIHZhciBpbmRpY2VzID0gdGFyZ2V0W21ldGFkYXRhS2V5XTtcclxuICAgICAgICBpZihBcnJheS5pc0FycmF5KGluZGljZXMpKXtcclxuICAgICAgICAgICAgZm9yKHZhciBpPTA7IGk8YXJncy5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgICAgICBpZihpbmRpY2VzLmluZGV4T2YoaSkgIT09IC0xKXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYXJnID0gYXJnc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYXJnU3RyID0gSlNPTi5zdHJpbmdpZnkoYXJnKSB8fCBhcmcudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgJHtrZXl9IGFyZ1ske2l9XTogJHthcmdTdHJ9YCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG9yaWdpbmFsTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3MpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBkZXNjcmlwdG9yO1xyXG59XHJcblxyXG4vL0RlY29yYXRvciBmYWN0b3J5XHJcbmZ1bmN0aW9uIGxvZyguLi5hcmdzOiBhbnlbXSl7XHJcbiAgICBzd2l0Y2goYXJncy5sZW5ndGgpe1xyXG4gICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgcmV0dXJuIGxvZ0NsYXNzLmFwcGx5KHRoaXMsIGFyZ3MpO1xyXG4gICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgbG9nUHJvcGVydHkuYXBwbHkodGhpcy4gYXJncyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgaWYodHlwZW9mIGFyZ3NbMl0gPT09IFwibnVtYmVyXCIpe1xyXG4gICAgICAgICAgICAgICAgbG9nUGFyYW1ldGVyLmFwcGx5KHRoaXMsIGFyZ3MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBsb2dNZXRob2QuYXBwbHkodGhpcywgYXJncyk7XHJcbiAgICAgICAgZGVmYXVsdDogXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRGVjb3JhdG9ycyBhcmUgbm90IHZhbGlkIGhlcmUhJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG4vL01WKlxyXG4vL01WVk0tPk1vZGVsIFZpZXcgVmlldy1Nb2RlbFxyXG4vL01WUFxyXG5cclxuLy9Nb2RlbFxyXG5jbGFzcyBUYXNrTW9kZWx7XHJcbiAgICBwdWJsaWMgY3JlYXRlZDogbnVtYmVyO1xyXG4gICAgcHVibGljIGNvbXBsZXRlZDogYm9vbGVhbjtcclxuICAgIHB1YmxpYyB0aXRsZTogc3RyaW5nO1xyXG59XHJcblxyXG4vL0NvbGxlY3Rpb25cclxuXHJcbi8vSXRlbSB2aWV3XHJcbi8vQ29sbGVjdGlvbiB2aWV3XHJcblxyXG4vL0NvbnRyb2xsZXJcclxuLy/nrqHnkIZ2aWV3IG1vZGVs55qE55Sf5ZG95ZGo5pyfXHJcbi8v5a6e5L6L5YyWbW9kZWwgY29sbGVjdGlvbiDlhbPogZTotbfmnaUg6IGU57O7dmlld1xyXG4vL+aOp+WItuadg+i9rOS6pOe7meWFtuS7lmNvbnRyb2xsZXLliY3plIDmr4Hku5bku6xcclxuLy9NVkMg6YCa6L+H57uE57uHY29udHJvbGxlcuWSjOWug+eahOaWueazlSDov5nkupvmlrnms5XlkoznlKjmiLfnmoTooYzkuLrkuIDkuIDlr7nlupRcclxuXHJcbi8vRXZlbnRcclxuLy9Vc2VyIGV2ZW50IOWFgeiuuOeUqOaIt+mAmui/h+inpuWPkeWkhOeQhueahOS6i+S7tiBjbGljayBzY3JvbGwgc3VibWl0XHJcbi8vUHJvZ3JhbSBldmVudCDlupTnlKjnqIvluo/oh6rouqvop6blj5HosIPnlKjnmoTkuovku7Ygb25SZW5kZXJcclxuXHJcbi8vUm91dGVyIGhhc2hcclxuY2xhc3MgUm91dGVye1xyXG4gICAgcHVibGljIGNvbnRyb2xsZXJOYW1lOiBzdHJpbmc7XHJcbiAgICBwdWJsaWMgYWN0aW9uTmFtZTogc3RyaW5nO1xyXG4gICAgcHVibGljIGFyZ3M6IE9iamVjdFtdO1xyXG4gICAgY29uc3RydWN0b3IoY29udHJvbGxlck5hbWU6IHN0cmluZywgYWN0aW9uTmFtZTpzdHJpbmcsIGFyZ3M6IE9iamVjdFtdKXtcclxuICAgICAgICB0aGlzLmNvbnRyb2xsZXJOYW1lID0gY29udHJvbGxlck5hbWU7XHJcbiAgICAgICAgdGhpcy5hY3Rpb25OYW1lID0gYWN0aW9uTmFtZTtcclxuICAgICAgICB0aGlzLmFyZ3MgPSBhcmdzO1xyXG4gICAgfVxyXG59Il19
